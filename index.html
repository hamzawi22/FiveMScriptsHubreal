<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FiveM Premium Store | Ù…ØªØ¬Ø± Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;700;900&display=swap');
        
        :root {
            --primary: #5865F2; /* Discord Blue */
            --accent: #9333ea;
            --bg-dark: #0a0a0c;
        }

        * { font-family: 'Cairo', sans-serif; transition: all 0.3s ease; }

        body {
            background-color: var(--bg-dark);
            color: #ffffff;
            background-image: 
                radial-gradient(circle at 10% 20%, rgba(88, 101, 242, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 90% 80%, rgba(147, 51, 234, 0.05) 0%, transparent 50%);
            min-height: 100vh;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.05);
            border-radius: 24px;
        }

        .discord-btn {
            background-color: #5865F2;
            box-shadow: 0 4px 15px rgba(88, 101, 242, 0.3);
        }

        .discord-btn:hover {
            background-color: #4752c4;
            transform: translateY(-2px);
        }

        .gradient-border {
            border: 2px solid transparent;
            background-image: linear-gradient(var(--bg-dark), var(--bg-dark)), linear-gradient(to right, #5865F2, #9333ea);
            background-origin: border-box;
            background-clip: padding-box, border-box;
        }

        /* Animations */
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .animate-fade { animation: fadeIn 0.5s ease-out; }
    </style>
</head>
<body>

<div id="app">
    </div>

<script>
    // --- Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø«Ø§Ø¨ØªØ© ---
    const ADMIN_EMAIL = 'obywawi@gmail.com';
    const DISCORD_CLIENT_ID = '1454211006866657384';
    // Ù…Ù„Ø§Ø­Ø¸Ø©: Ø§Ù„Ù€ Redirect URI ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ·Ø§Ø¨Ù‚ ØªÙ…Ø§Ù…Ø§Ù‹ Ø§Ù„Ù…Ø³Ø¬Ù„ ÙÙŠ Discord Developer Portal
    const REDIRECT_URI = window.location.origin + window.location.pathname;

    const firebaseConfig = {
        apiKey: "AIzaSyDbW67rYjVnUdzoF9FvfLJypGi_MF9nQjg",
        authDomain: "login-system-124a6.firebaseapp.com",
        projectId: "login-system-124a6",
        storageBucket: "login-system-124a6.firebasestorage.app",
        messagingSenderId: "667998653226",
        appId: "1:667998653226:web:bc4a96a2dbbd22cf386c53"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();

    // --- Ø­Ø§Ù„Ø© Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ (State) ---
    let state = {
        user: null,
        view: 'home', // 'home' or 'details'
        scripts: [],
        selectedScript: null,
        modals: { auth: false, upload: false }
    };

    // --- Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ®Ø²ÙŠÙ† ---
    const db = {
        async saveScript(script) {
            const list = await this.getScripts();
            list.push(script);
            localStorage.setItem('hub_scripts', JSON.stringify(list));
        },
        async getScripts() {
            const data = localStorage.getItem('hub_scripts');
            return data ? JSON.parse(data) : [];
        }
    };

    // --- ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯ ---
    function loginWithDiscord() {
        const scope = encodeURIComponent('identify email');
        const url = `https://discord.com/api/oauth2/authorize?client_id=${DISCORD_CLIENT_ID}&redirect_uri=${encodeURIComponent(REDIRECT_URI)}&response_type=token&scope=${scope}`;
        window.location.href = url;
    }

    async function handleDiscordCallback() {
        const fragment = new URLSearchParams(window.location.hash.slice(1));
        const token = fragment.get('access_token');
        
        if (token) {
            try {
                const response = await fetch('https://discord.com/api/users/@me', {
                    headers: { Authorization: `Bearer ${token}` }
                });
                const data = await response.json();
                
                const userObj = {
                    uid: 'discord_' + data.id,
                    name: data.global_name || data.username,
                    email: data.email || `${data.username}@discord.com`,
                    photo: data.avatar ? `https://cdn.discordapp.com/avatars/${data.id}/${data.avatar}.png` : `https://ui-avatars.com/api/?name=${data.username}`
                };
                
                state.user = userObj;
                localStorage.setItem('hub_user', JSON.stringify(userObj));
                window.location.hash = ''; // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø±Ø§Ø¨Ø·
                render();
            } catch (err) {
                console.error("Discord Login Error:", err);
            }
        }
    }

    // --- Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ---
    function logout() {
        auth.signOut();
        state.user = null;
        localStorage.removeItem('hub_user');
        render();
    }

    async function uploadScript(e) {
        e.preventDefault();
        const form = e.target;
        const file = form.scriptFile.files[0];
        const image = form.scriptImage.files[0];

        const reader = (f) => new Promise(res => {
            const r = new FileReader();
            r.onload = (ev) => res(ev.target.result);
            r.readAsDataURL(f);
        });

        const newScript = {
            id: Date.now(),
            title: form.title.value,
            desc: form.desc.value,
            category: form.category.value,
            author: state.user.name,
            file: await reader(file),
            fileName: file.name,
            image: image ? await reader(image) : null,
            date: new Date().toLocaleDateString('ar-EG')
        };

        await db.saveScript(newScript);
        state.modals.upload = false;
        render();
    }

    // --- ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… (UI) ---
    async function render() {
        const app = document.getElementById('app');
        const scripts = await db.getScripts();
        const isAdmin = state.user && state.user.email === ADMIN_EMAIL;

        app.innerHTML = `
            <nav class="p-6 flex justify-between items-center max-w-7xl mx-auto">
                <div class="flex items-center gap-2 cursor-pointer" onclick="state.view='home';render()">
                    <div class="w-10 h-10 bg-gradient-to-tr from-blue-600 to-purple-600 rounded-lg flex items-center justify-center font-bold text-xl italic">F</div>
                    <span class="text-xl font-black tracking-tighter">FIVEM <span class="text-blue-500">HUB</span></span>
                </div>

                <div class="flex items-center gap-4">
                    ${state.user ? `
                        ${isAdmin ? `<button onclick="state.modals.upload=true;render()" class="bg-white/10 hover:bg-white/20 px-4 py-2 rounded-xl text-sm font-bold border border-white/10">Ù†Ø´Ø± Ø³ÙƒØ±Ø¨Øª +</button>` : ''}
                        <div class="flex items-center gap-3 bg-white/5 p-1 pr-4 rounded-full border border-white/5">
                            <span class="text-sm font-bold">${state.user.name}</span>
                            <img src="${state.user.photo}" onclick="logout()" class="w-8 h-8 rounded-full border border-blue-500 cursor-pointer hover:opacity-80" title="Ø®Ø±ÙˆØ¬">
                        </div>
                    ` : `
                        <button onclick="state.modals.auth=true;render()" class="discord-btn px-6 py-2.5 rounded-xl font-bold text-sm">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</button>
                    `}
                </div>
            </nav>

            <main class="max-w-7xl mx-auto px-6 py-8">
                ${state.view === 'home' ? `
                    <header class="text-center py-16 animate-fade">
                        <h1 class="text-5xl md:text-7xl font-black mb-6 leading-tight">Ø¹Ø²Ø² Ø³ÙŠØ±ÙØ±Ùƒ Ø¨Ø£ÙØ¶Ù„ <br><span class="text-blue-500 italic">Ø§Ù„Ø³ÙƒØ±Ø¨ØªØ§Øª</span> Ø§Ù„Ø­ØµØ±ÙŠØ©</h1>
                        <p class="text-gray-400 max-w-2xl mx-auto text-lg">Ù…Ù†ØµØ© Ù…ØªÙƒØ§Ù…Ù„Ø© Ù„ØªØ­Ù…ÙŠÙ„ ÙˆØªØ¬Ø±Ø¨Ø© Ø£Ø­Ø¯Ø« Ø§Ù„Ø¨Ø±Ù…Ø¬ÙŠØ§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ù€ FiveMØŒ Ù…Ø¯Ø¹ÙˆÙ…Ø© Ø¨Ù†Ø¸Ø§Ù… Ø­Ù…Ø§ÙŠØ© Ø¹Ø§Ù„ÙŠ.</p>
                    </header>

                    <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                        ${scripts.length ? scripts.map(s => `
                            <div onclick="state.selectedScript=${JSON.stringify(s).replace(/"/g, '&quot;')}; state.view='details'; render()" class="glass-card group cursor-pointer hover:border-blue-500/50 overflow-hidden">
                                <div class="h-48 bg-white/5 relative">
                                    ${s.image ? `<img src="${s.image}" class="w-full h-full object-cover group-hover:scale-105">` : `<div class="w-full h-full flex items-center justify-center text-5xl opacity-20">ğŸ“¦</div>`}
                                    <div class="absolute top-4 right-4 bg-blue-600 text-[10px] px-2 py-1 rounded font-bold uppercase tracking-widest">${s.category}</div>
                                </div>
                                <div class="p-6">
                                    <h3 class="text-xl font-bold mb-2">${s.title}</h3>
                                    <div class="flex items-center justify-between text-gray-500 text-sm">
                                        <span>Ø¨ÙˆØ§Ø³Ø·Ø© ${s.author}</span>
                                        <span>${s.date}</span>
                                    </div>
                                </div>
                            </div>
                        `).join('') : `
                            <div class="col-span-full text-center py-20 border-2 border-dashed border-white/5 rounded-3xl">
                                <p class="text-gray-500">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø³ÙƒØ±Ø¨ØªØ§Øª Ø­Ø§Ù„ÙŠØ§Ù‹.</p>
                            </div>
                        `}
                    </div>
                ` : `
                    <div class="max-w-4xl mx-auto animate-fade">
                        <button onclick="state.view='home';render()" class="mb-8 text-gray-400 hover:text-white flex items-center gap-2">â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ù…ØªØ¬Ø±</button>
                        <div class="grid md:grid-cols-2 gap-10">
                            <div>
                                ${state.selectedScript.image ? `<img src="${state.selectedScript.image}" class="w-full rounded-3xl shadow-2xl">` : `<div class="w-full aspect-square bg-white/5 rounded-3xl flex items-center justify-center text-6xl">ğŸ“¦</div>`}
                            </div>
                            <div>
                                <h1 class="text-4xl font-black mb-4">${state.selectedScript.title}</h1>
                                <div class="flex gap-2 mb-6 text-sm">
                                    <span class="bg-white/10 px-3 py-1 rounded-full text-blue-400 font-bold">${state.selectedScript.category}</span>
                                    <span class="bg-white/10 px-3 py-1 rounded-full text-gray-400">${state.selectedScript.date}</span>
                                </div>
                                <p class="text-gray-400 leading-relaxed mb-8 text-lg">${state.selectedScript.desc}</p>
                                <a href="${state.selectedScript.file}" download="${state.selectedScript.fileName}" class="block text-center discord-btn py-4 rounded-2xl font-black text-xl">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³ÙƒØ±Ø¨Øª Ù…Ø¬Ø§Ù†Ø§Ù‹</a>
                            </div>
                        </div>
                    </div>
                `}
            </main>

            ${state.modals.auth ? `
                <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="state.modals.auth=false;render()"></div>
                    <div class="glass-card p-10 w-full max-w-md relative animate-fade">
                        <h2 class="text-3xl font-black text-center mb-8">Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨Ùƒ Ù…Ø¬Ø¯Ø¯Ø§Ù‹</h2>
                        <button onclick="loginWithDiscord()" class="w-full discord-btn flex items-center justify-center gap-4 py-4 rounded-2xl font-bold mb-4">
                            <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M20.317 4.37a19.791 19.791 0 0 0-4.885-1.515a.074.074 0 0 0-.079.037c-.21.375-.444.864-.608 1.25a18.27 18.27 0 0 0-5.487 0a12.64 12.64 0 0 0-.617-1.25a.077.077 0 0 0-.079-.037A19.736 19.736 0 0 0 3.677 4.37a.07.07 0 0 0-.032.027C.533 9.046-.32 13.58.099 18.057a.082.082 0 0 0 .031.057a19.9 19.9 0 0 0 5.993 3.03a.078.078 0 0 0 .084-.028a14.09 14.09 0 0 0 1.226-1.994a.076.076 0 0 0-.041-.106a13.107 13.107 0 0 1-1.872-.892a.077.077 0 0 1-.008-.128a10.2 10.2 0 0 0 .372-.292a.074.074 0 0 1 .077-.01c3.928 1.793 8.18 1.793 12.062 0a.074.074 0 0 1 .078.01c.12.098.246.198.373.292a.077.077 0 0 1-.006.127a12.299 12.299 0 0 1-1.873.892a.077.077 0 0 0-.041.107c.36.698.772 1.362 1.225 1.993a.076.076 0 0 0 .084.028a19.839 19.839 0 0 0 6.002-3.03a.077.077 0 0 0 .032-.054c.5-5.177-.838-9.674-3.549-13.66a.06.06 0 0 0-.031-.03z"/></svg>
                            Ø¯Ø®ÙˆÙ„ Ø¨ÙˆØ§Ø³Ø·Ø© Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
                        </button>
                        <p class="text-center text-gray-500 text-xs">Ø¨ØªØ³Ø¬ÙŠÙ„Ùƒ Ø£Ù†Øª ØªÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù…Ø¬ØªÙ…Ø¹</p>
                    </div>
                </div>
            ` : ''}

            ${state.modals.upload ? `
                <div class="fixed inset-0 z-50 flex items-center justify-center p-4">
                    <div class="absolute inset-0 bg-black/90" onclick="state.modals.upload=false;render()"></div>
                    <form onsubmit="uploadScript(event)" class="glass-card p-8 w-full max-w-2xl relative animate-fade max-h-[90vh] overflow-y-auto">
                        <h2 class="text-2xl font-black mb-6">Ø±ÙØ¹ Ø³ÙƒØ±Ø¨Øª Ø¬Ø¯ÙŠØ¯</h2>
                        
                        <div class="grid md:grid-cols-2 gap-4">
                            <input type="text" name="title" placeholder="Ø§Ø³Ù… Ø§Ù„Ø³ÙƒØ±Ø¨Øª" required class="bg-white/5 p-4 rounded-xl outline-none focus:border-blue-500 border border-white/5">
                            <select name="category" class="bg-white/5 p-4 rounded-xl outline-none border border-white/5">
                                <option value="Scripts">Scripts</option>
                                <option value="Maps">Maps</option>
                                <option value="Cars">Cars</option>
                                <option value="UI">UI Layouts</option>
                            </select>
                        </div>
                        
                        <textarea name="desc" placeholder="ÙˆØµÙ ÙƒØ§Ù…Ù„ Ø¹Ù† Ø§Ù„Ø³ÙƒØ±Ø¨Øª ÙˆÙ…Ù…ÙŠØ²Ø§ØªÙ‡..." required class="w-full bg-white/5 p-4 rounded-xl h-32 my-4 outline-none border border-white/5"></textarea>
                        
                        <div class="grid md:grid-cols-2 gap-4 mb-6">
                            <div>
                                <label class="block text-xs text-gray-500 mb-2">ØµÙˆØ±Ø© Ø§Ù„Ø¹Ø±Ø¶ (PNG/JPG)</label>
                                <input type="file" name="scriptImage" accept="image/*" class="text-xs file:bg-white/10 file:text-white file:border-0 file:rounded-lg file:px-4 file:py-2">
                            </div>
                            <div>
                                <label class="block text-xs text-gray-500 mb-2">Ù…Ù„Ù Ø§Ù„Ø³ÙƒØ±Ø¨Øª (Zip/Rar)</label>
                                <input type="file" name="scriptFile" accept=".zip,.rar" required class="text-xs file:bg-blue-600 file:text-white file:border-0 file:rounded-lg file:px-4 file:py-2">
                            </div>
                        </div>

                        <button type="submit" class="w-full bg-white text-black py-4 rounded-2xl font-black hover:bg-blue-500 hover:text-white">ØªØ£ÙƒÙŠØ¯ ÙˆÙ†Ø´Ø±</button>
                    </form>
                </div>
            ` : ''}
        `;
    }

    // --- ØªØ´ØºÙŠÙ„ Ø§Ù„Ù†Ø¸Ø§Ù… ---
    window.onload = () => {
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ÙˆØ¬ÙˆØ¯ Ù…Ø³ØªØ®Ø¯Ù… Ù…Ø³Ø¬Ù„ Ù…Ø³Ø¨Ù‚Ø§Ù‹
        const savedUser = localStorage.getItem('hub_user');
        if (savedUser) state.user = JSON.parse(savedUser);
        
        // Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¹ÙˆØ¯Ø© Ù…Ù† Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
        handleDiscordCallback();
        
        render();
    };

</script>

</body>
</html>
